{% extends 'tweets/base.html' %}

{% block head_title %}
Amazing 
{% endblock head_title %}

{% block content %}
Welcome To Babble
<div id='tweets'>
  Loading...
</div>

<script>
  const tweetsElement = document.getElementById("tweets")
  // tweetsElement.innerHTML = 'Loading...'
  // var el1 = "<h1>Hi There</h1>"
  // var el2 = "<h1>Hi There 2</h1>"
  // var el3 = "<h1>Hi There 3</h1>"
  // tweetsElement.innerHTML = el1 + el2 + el3  
  const xhr = new XMLHttpRequest() //xhr = someClass()
  const method ='GET'
  const url ='/babbles'
  const responseType ='json'

function formatTweetElement(tweet){

  var formattedTweet ='<div class = "mb-4 tweet" id="tweet-'+tweet.id+'"><h1>' + tweet.id +'</h1>' + '<p>' + tweet.content +'</p></div>'
  return formattedTweet
}
  xhr.responseType = responseType
  xhr.open(method,url)
  xhr.onload = function(){
    const serverResponse = xhr.response
    var listedItems = serverResponse.response
    var finalTweetStr = ""
    var i
    for (i=0;i<listedItems.length;i++){
      console.log(listedItems[i])
      var tweetObj = listedItems[i]
      // var currentItem ='<div class = "mb-4" ><h1>' + listedItems[i].id +'</h1>' + '<p>' + listedItems[i].content +'</p></div>'
      var currentItem = formatTweetElement(tweetObj)
      finalTweetStr += currentItem
    }
    tweetsElement.innerHTML = finalTweetStr
    console.log(xhr.response)
  }
  xhr.send()
</script>
{% endblock content %}